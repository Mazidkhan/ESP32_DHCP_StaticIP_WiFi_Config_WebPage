<!DOCTYPE html>
<html>
<head>
  <title>ESP32 Wi-Fi Setup</title>
  <script src="/esp.js"></script>  <!-- Linking the external JavaScript file -->
  <style>
    body { font-family: Arial, sans-serif; background-color: #f2f2f2; margin: 0; padding: 0; }
    h1, h2 { color: #333; text-align: center; }
    button { background-color: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
    button:hover { background-color: #45a049; }
    .modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); }
    .modal-content { background-color: #fff; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 30%; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
    .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; }
    .close:hover, .close:focus { color: red; text-decoration: none; cursor: pointer; }
    #staticFields { display: none; margin-top: 10px; }
    .container { padding: 20px; text-align: center; }
    ul { list-style-type: none; padding: 0; }
    li { background: #ddd; margin: 5px 0; padding: 8px; border-radius: 5px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ESP32 Wi-Fi Setup</h1>
    <h2>BME280 Sensor Data</h2>
    <p id="temperature">Temperature: Loading...</p>
    <p id="humidity">Humidity: Loading...</p>
    <button onclick="showSection('networkSection')">Network</button>
    <button onclick="showSection('calibrationSection')">Calibration</button>
    
    <!-- Network Section -->
    <div id="networkSection" style="display:none;">
      <h2>Available Networks</h2>
      <ul id="availableNetworksList"></ul>
      <button onclick="showConnectWiFi()">Connect Wi-Fi</button>
      <button onclick="showIPMode()">IP Mode</button>

      <div id="connectWiFiModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeModal('connectWiFiModal')">&times;</span>
          <h2>Connect to Wi-Fi</h2>
          <form action="/connect" method="POST">
            SSID: <input type="text" name="wifi_name"><br>
            Password: <input type="password" name="wifi_password"><br>
            <input type="submit" value="Submit">
          </form>
        </div>
      </div>

      <div id="ipModeModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeModal('ipModeModal')">&times;</span>
          <h2>Set IP Mode</h2>
          <form action="/set_ip_mode" method="POST">
            Select Mode: <select name="ip_mode" id="ip_mode" onchange="toggleIPFields()">
              <option value="dhcp">DHCP</option>
              <option value="static">Static</option>
            </select><br>
            <div id="staticFields">
              Static IP: <input type="text" name="static_ip" placeholder="192.168.0.200"><br>
              Gateway: <input type="text" name="gateway_ip" placeholder="192.168.0.1"><br>
              Subnet: <input type="text" name="subnet_ip" placeholder="255.255.255.0"><br>
            </div>
            <input type="submit" value="Set IP Mode">
          </form>
          <p id="ipModeText">IP Mode: DHCP</p>
        </div>
      </div>
      <h2>Connected Network</h2>
      <p id="connectedNetwork">Fetching connected network...</p> <!-- This will show the connected Wi-Fi SSID -->
    </div>

    <!-- Calibration Section -->
    <div id="calibrationSection" style="display:none;">
      <h2>Calibration</h2>
    </div>
  </div>
</body>
</html>
